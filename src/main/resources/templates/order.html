<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cart</title>

  <link rel = "stylesheet" href = "/order.css">

</head>
<body align=center>

<h1>Order Item</h1>
 
<div class="shopping-cart">
 
  <div class="column-labels">
    <label class="product-image">Image</label>
    <label class="product-details">Product</label>
    <label class="product-price">Price</label>
    <label class="product-quantity">Quantity</label>
    <label class="product-removal">Remove</label>
    <label class="product-line-price">Total</label>
  </div>
 
  <div class="product">
    <div class="product-image">
      <img src="image.jpg">
    </div>
    <div class="product-details">
      <div class="product-title">Shoes</div>
      <p class="product-description"> excellent product</p>
    </div>
    <div class="product-price">12.99</div>
    <div class="product-quantity" onchange="calculateTotal">
      <input id="id"  type="number" value="2" min="1">
    </div>
    <div class="product-removal">
      <button class="remove-product">
        Remove
      </button>
    </div>
    <div class="product-line-price">25.98</div>
  </div>
 
  <div class="totals">
    <div class="totals-item">
      <label>Subtotal</label>
      <div class="totals-value" id="sub_total">71.97</div>
    </div>
    <div class="totals-item">
      <label>Tax (5%)</label>
      <div class="totals-value" id="cart-tax">3.60</div>
    </div>
    <div class="totals-item totals-item-total">
      <label>Grand Total</label>
      <div class="totals-value" id="cart-total">90.57</div>
    </div>
  </div>
       
      <button class="checkout">Order</button>
 
</div>

</body>

<script>

window.addEventListener('load',calculateGrandTotal);


   function calculateTotal(id, unitPrice){


         const quantity = document.getElementById(id).value;

         //document.getElementById('sub_total'+id).innerHTML = (quantity *  unitPrice);
         document.getElementById('sub_total').innerHTML = (quantity *  unitPrice);

         calculateGrandTotal();

        }


        function calculateGrandTotal(){
                let total = 0;
                let sub_totals = document.getElementsByClassName('sub_total');


                for(let i=0; i< sub_totals.length ; i++ ){
                    total += parseInt(sub_totals[i].innerHTML);
                 }


                document.getElementById('total').innerHTML = total;

        }



        function update(url){
                let items = []
                products = document.getElementsByClassName('product');
                for(let i=0; i<products.length; i++){
                    quantity = products[i].getElementsByTagName('input')[0];
                    let item = {
                      'id': quantity.id,
                      'quantity': quantity.value

                    }
                    items.push(item);
                }

                postUpdate(url, items)
                .then(data => {
                       createAlert('success','Updated Successfully');
                  })
                  .catch((error) => {
                     createAlert('warning',error);
                  });
             }

             async function postUpdate(url, data){
                   const response = await fetch(url, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json',},
                        body: JSON.stringify(data),
                      });

                      return response.json();
             }

            
</script>
</html>
